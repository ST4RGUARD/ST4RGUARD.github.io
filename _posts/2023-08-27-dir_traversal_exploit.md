---
layout: post
title: Directory Traversal Exploit
titledate: 08/27/23
tags: ["infosec","offsec", "web", "wordpress","exploit","shell","dir_traversal"]
---

<h4>Linux</h4>

When browsing a site we can hover over links to get an idea of the directory structure of the web application on the server.

Of course using tools like gobuster or feroxbuster can help us enumerate this dir structure easily, but it may be possible to perform directory traversal attack by traversing directories to try to access content outside of the web server

    $ http://vulnwebapp.com/home/index.php?page=../../../../../../../../../etc/passwd

You only need to give the minimum number of ../ to get to the root directory from the current working directory of the web page you are on, however, since there is no maximum we can just provide a large number of ../ to get to the root path

From the above command we can obtain a list of users on the system. With this information we learn about a user DON. We can try to find DON's ssh key with a typical directory layout 

    $ http://vulnwebapp.com/home/index.php?page=../../../../../../../../../home/DON/.ssh/id_rsa

If this request returns the private ssh key for don , we should use a different procedure to obtain the key as displaying content in the web browser can often get skewed as many characters may not be properly encoded. We can use wget, curl, or python/ruby to retrieve this information

    $ curl http://vulnwebapp.com/home/index.php?page=../../../../../../../../../home/DON/.ssh/id_rsa

Once we obtain the key we need to change the permissions on it because they are too open

    $ chmod 400 don_key

Now we can attempt to ssh to the machine hosting the vulnerable web server

    $ ssh -i don_key -p 2222 don@vulnwebapp.com

<h4>Windows</h4>

Windows is a little more difficult to obtain useable information than linux

    $ C:\Windows\System32\drivers\etc\hosts

This file should be accessible by all users and useful to try dir traversal attacks

<h3>We can not reach useful ssh data like we do for Linux, but information disclosure can still be relevant depending on what directory contents we can disclose</h3>

    $ C:\inetpub\logs\LogFiles\W3SVC1
    $ C:\inetpub\wwwroot\web.config

The files above both contain information about the IIS server, so it is always worth probing the directories to see what we can find